#tag WindowBegin Window melupdatewindow   BackColor       =   16777215   Backdrop        =   ""   CloseButton     =   True   Composite       =   True   Frame           =   0   FullScreen      =   False   HasBackColor    =   False   Height          =   193   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   1408782882   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   "Posting Melative Update"   Visible         =   True   Width           =   534   Begin StaticText titletext      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   19      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Text            =   "Untitled"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   6      Underline       =   ""      Visible         =   True      Width           =   494   End   Begin StaticText StaticText2      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   20      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Text            =   "Action:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   36      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin BevelButton BevelButton1      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   0      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "?"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   "See a valid list of actions that can be used on melative"      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   302      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      MenuValue       =   0      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   0      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   34      Underline       =   False      Value           =   False      Visible         =   True      Width           =   30   End   Begin TextArea commentsfield      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   52      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   112      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Mask            =   ""      Multiline       =   True      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   67      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   389   End   Begin StaticText StaticText3      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   19      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Text            =   "Message:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   67      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin CheckBox CheckBox1      AutoDeactivate  =   True      Bold            =   ""      Caption         =   "Include Episode Information"      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   17      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      State           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   159      Underline       =   ""      Value           =   False      Visible         =   True      Width           =   271   End   Begin PushButton PushButton1      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "Post"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   443      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   159      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin httpsocket socket1      Address         =   ""      Height          =   32      Index           =   -2147483648      Left            =   390      LockedInPosition=   False      Port            =   0      Scope           =   0      TabPanelIndex   =   0      Top             =   19      Width           =   32      yield           =   0   End   Begin StaticText StaticText1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   17      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Multiline       =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Text            =   "Episode:"      TextAlign       =   0      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   128      Underline       =   ""      Visible         =   True      Width           =   100   End   Begin TextField epi      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      BackColor       =   16777215      Bold            =   ""      Border          =   True      CueText         =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   22      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   112      LimitText       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Mask            =   ""      Password        =   ""      ReadOnly        =   ""      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   0      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   128      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   56   End   Begin ComboBox TextField1      AutoComplete    =   False      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialValue    =   "watching\rwrite\ron\r"      Italic          =   ""      Left            =   112      ListIndex       =   0      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   ""      LockRight       =   ""      LockTop         =   ""      Scope           =   0      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   35      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   176   EndEnd#tag EndWindow#tag WindowCode	#tag Event		Function CancelClose(appQuitting as Boolean) As Boolean		  if modified = true then		    Dim d as New MessageDialog //declare the MessageDialog object		    Dim b as MessageDialogButton //for handling the result		    d.icon=MessageDialog.GraphicCaution //display warning icon		    d.ActionButton.Caption="Discard"		    d.CancelButton.Visible=True    //show the Cancel button		    d.Message="Are you sure you want to discard this unsaved update?"		    d.Explanation="Your update will be lost."		    b=d.ShowModalWithin(self.TrueWindow)//display the dialog		    Select Case b //determine which button was pressed.		    Case d.ActionButton		      //user pressed Delete		      return false		    Case d.CancelButton		      //user pressed Cancel		      return true		    End select		  else		    return false		  end if		End Function	#tag EndEvent	#tag MenuHandler		Function FileClose() As Boolean Handles FileClose.Action			self.close			Return True					End Function	#tag EndMenuHandler	#tag Method, Flags = &h0		Sub melpostupdate()		  pushbutton1.enabled = false		  dim data as string		  		  // create and populate the form object		  dim form2 as New Dictionary		  // Set content		  		  // Use Normal Updating		  // Figure out the num of episodes. If zero, episode part will not be shown in the update		  If checkbox1.value= true then		    If epi.text = "" then		      form2.value("message") = TextField1.text + " /anime/" + titletext.text + "/ : " + commentsfield.text		    else		      form2.value("message") = TextField1.text + " /anime/" + titletext.text+ "/Episode "+ epi.text + ": " + commentsfield.text		    end if		  else		    form2.value("message") = TextField1.text + " /anime/" + titletext.text + "/ : " + commentsfield.text		  end if		  // Set Client ( e.g. <username> in anime <time> ago from MAL Client OS X)		  form2.value("source") = "Melative Library"		  // setup the socket to POST the form		  socket1.setFormData form2		  socket1.setrequestheader "Authorization","Basic " + app.loginenc		  data = socket1.post("http://melative.com/api/micro/update.json",10)		  		  // release data from memory		  form2 = nil		  If socket1.httpstatuscode = 200 then		    commentsfield.text = ""		    pushbutton1.enabled = true		    self.IsModified = false		    modified = false		  else		    // Show Error		    self.errboxshow("Melative Library was unable to post your update on Melative",   "Check to see if your internet connection is working or revertify your Melative account information and try posting your update again.")		    pushbutton1.enabled = true		  end if		  		End Sub	#tag EndMethod	#tag Property, Flags = &h0		modified As boolean	#tag EndProperty#tag EndWindowCode#tag Events BevelButton1	#tag Event		Sub Action()		  showurl "http://melative.pbworks.com/Known-Action-Verbs"		End Sub	#tag EndEvent#tag EndEvents#tag Events commentsfield	#tag Event		Sub TextChange()		  self.IsModified = true		  modified = true		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton1	#tag Event		Sub Action()		  If textfield1.text = "" then		    self.errboxshow("Melative Library was unable to post the update.", "You cannot leave the action field blank. You must use a valid action or 'on' to post this update")		  else		    if commentsfield.text = "" then		      self.errboxshow("Melative Library was unable to post the update.", "You cannot leave the message field blank. You must have a message written.")		    else		      melpostupdate		    end if		  end if		End Sub	#tag EndEvent#tag EndEvents#tag Events epi	#tag Event		Function KeyDown(Key As String) As Boolean		  if instr("0123456789."+chr(28)+ chr(29)+ chr(30)+ chr(31)+chr(3)+chr(9)+chr(10)+chr(8),key)>-1 then		    // handle specific keys from our list		  else		    // ignore the key		    return true		  end		End Function	#tag EndEvent#tag EndEvents