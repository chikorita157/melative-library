#tag WindowBegin Window editmsg   BackColor       =   &hFFFFFF   Backdrop        =   ""   CloseButton     =   True   Composite       =   False   Frame           =   8   FullScreen      =   False   HasBackColor    =   False   Height          =   1.56e+2   ImplicitInstance=   True   LiveResize      =   False   MacProcID       =   0   MaxHeight       =   32000   MaximizeButton  =   False   MaxWidth        =   32000   MenuBar         =   ""   MenuBarVisible  =   True   MinHeight       =   64   MinimizeButton  =   False   MinWidth        =   64   Placement       =   0   Resizeable      =   False   Title           =   ""   Visible         =   True   Width           =   3.75e+2   Begin StaticText StaticText1      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   13      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      TabIndex        =   0      TabPanelIndex   =   0      Text            =   "Message:"      TextAlign       =   2      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   12      TextUnit        =   0      Top             =   31      Underline       =   ""      Visible         =   True      Width           =   75   End   Begin TextArea commentsfield      AcceptTabs      =   ""      Alignment       =   0      AutoDeactivate  =   True      BackColor       =   &hFFFFFF      Bold            =   ""      Border          =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Format          =   ""      Height          =   62      HelpTag         =   ""      HideSelection   =   True      Index           =   -2147483648      Italic          =   ""      Left            =   100      LimitText       =   0      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Mask            =   ""      Multiline       =   True      ReadOnly        =   ""      Scope           =   0      ScrollbarHorizontal=   ""      ScrollbarVertical=   True      Styled          =   True      TabIndex        =   1      TabPanelIndex   =   0      TabStop         =   True      Text            =   ""      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   0      TextUnit        =   0      Top             =   56      Underline       =   ""      UseFocusRing    =   False      Visible         =   True      Width           =   262   End   Begin BevelButton smallbut      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   &h000000      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "small"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   249      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   ""      LockTop         =   False      MenuValue       =   0      Scope           =   0      TabIndex        =   2      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   30      Underline       =   False      Value           =   False      Visible         =   True      Width           =   43   End   Begin BevelButton bigbut      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   &h000000      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "big"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   ""      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   207      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   ""      LockTop         =   False      MenuValue       =   0      Scope           =   0      TabIndex        =   3      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   30      Underline       =   False      Value           =   False      Visible         =   True      Width           =   38   End   Begin BevelButton delbut      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   &h000000      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "del"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   "Strike"      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   167      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   ""      LockTop         =   False      MenuValue       =   0      Scope           =   0      TabIndex        =   4      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   30      Underline       =   False      Value           =   False      Visible         =   True      Width           =   37   End   Begin BevelButton ItalicBut      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   &h000000      Bevel           =   0      Bold            =   False      ButtonType      =   0      Caption         =   "i"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   "Italic"      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   True      Left            =   134      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   ""      LockTop         =   False      MenuValue       =   0      Scope           =   0      TabIndex        =   5      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   30      Underline       =   False      Value           =   False      Visible         =   True      Width           =   29   End   Begin BevelButton BoldBut      AcceptFocus     =   False      AutoDeactivate  =   True      BackColor       =   &h000000      Bevel           =   0      Bold            =   True      ButtonType      =   0      Caption         =   "b"      CaptionAlign    =   3      CaptionDelta    =   0      CaptionPlacement=   1      Enabled         =   True      HasBackColor    =   False      HasMenu         =   0      Height          =   22      HelpTag         =   "Bold"      Icon            =   ""      IconAlign       =   0      IconDX          =   0      IconDY          =   0      Index           =   -2147483648      InitialParent   =   ""      Italic          =   False      Left            =   102      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   ""      LockTop         =   False      MenuValue       =   0      Scope           =   0      TabIndex        =   6      TabPanelIndex   =   0      TabStop         =   True      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   ""      TextUnit        =   0      Top             =   30      Underline       =   False      Value           =   False      Visible         =   True      Width           =   29   End   Begin PushButton PushButton1      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   ""      Caption         =   "&Save"      Default         =   True      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   282      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   7      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   12      TextUnit        =   0      Top             =   124      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin PushButton PushButton2      AutoDeactivate  =   True      Bold            =   ""      Cancel          =   True      Caption         =   "&Cancel"      Default         =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   190      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   8      TabPanelIndex   =   0      TabStop         =   True      TextFont        =   "System"      TextSize        =   12      TextUnit        =   0      Top             =   124      Underline       =   ""      Visible         =   True      Width           =   80   End   Begin StaticText MessageLength      AutoDeactivate  =   True      Bold            =   ""      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   312      LockBottom      =   False      LockedInPosition=   False      LockLeft        =   False      LockRight       =   False      LockTop         =   False      Multiline       =   ""      Scope           =   0      TabIndex        =   9      TabPanelIndex   =   0      Text            =   1000      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   11      TextUnit        =   0      Top             =   31      Underline       =   ""      Visible         =   True      Width           =   50   End   Begin StaticText EditIDMsg      AutoDeactivate  =   True      Bold            =   True      DataField       =   ""      DataSource      =   ""      Enabled         =   True      Height          =   20      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Italic          =   ""      Left            =   12      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Multiline       =   ""      Scope           =   0      TabIndex        =   10      TabPanelIndex   =   0      Text            =   "Editing Update: "      TextAlign       =   0      TextColor       =   &h000000      TextFont        =   "System"      TextSize        =   12      TextUnit        =   0      Top             =   6      Underline       =   ""      Visible         =   True      Width           =   203   End   Begin ProgressWheel ProgressWheel1      AutoDeactivate  =   True      Enabled         =   True      Height          =   16      HelpTag         =   ""      Index           =   -2147483648      InitialParent   =   ""      Left            =   12      LockBottom      =   ""      LockedInPosition=   False      LockLeft        =   True      LockRight       =   ""      LockTop         =   True      Scope           =   0      TabIndex        =   11      TabPanelIndex   =   0      TabStop         =   True      Top             =   124      Visible         =   False      Width           =   16   EndEnd#tag EndWindow#tag WindowCode	#tag Property, Flags = &h0		entry_id As string	#tag EndProperty	#tag Property, Flags = &h0		success As boolean = false	#tag EndProperty#tag EndWindowCode#tag Events commentsfield	#tag Event		Sub TextChange()		  MessageLength.text = cstr(1000-Len(commentsfield.text))		End Sub	#tag EndEvent#tag EndEvents#tag Events smallbut	#tag Event		Sub Action()		  commentsfield.text = commentsfield.text + "<small></small>"		  commentsfield.selstart = commentsfield.text.Len		End Sub	#tag EndEvent#tag EndEvents#tag Events bigbut	#tag Event		Sub Action()		  commentsfield.text = commentsfield.text + "<big></big>"		  commentsfield.selstart = commentsfield.text.Len		End Sub	#tag EndEvent#tag EndEvents#tag Events delbut	#tag Event		Sub Action()		  commentsfield.text = commentsfield.text + "<del></del>"		  commentsfield.selstart = commentsfield.text.Len		End Sub	#tag EndEvent#tag EndEvents#tag Events ItalicBut	#tag Event		Sub Action()		  commentsfield.text = commentsfield.text + "<i></i>"		  commentsfield.selstart = commentsfield.text.Len		End Sub	#tag EndEvent#tag EndEvents#tag Events BoldBut	#tag Event		Sub Action()		  commentsfield.text = commentsfield.text + "<b></b>"		  commentsfield.selstart = commentsfield.text.Len		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton1	#tag Event		Sub Action()		  dim socket1 as new httpsocket		  progresswheel1.visible = true		  pushbutton1.enabled = false		  dim data as string		  		  // create and populate the form object		  dim form2 as New Dictionary		  // Set content		  form2.value("entry_id") = entry_id		  form2.value("text") = ReplaceLineEndings(commentsfield.text, EndOfLine.UNIX)		  // setup the socket to POST the form		  socket1.setFormData form2		  socket1.setrequestheader "Authorization","Basic " + app.loginenc		  data = socket1.post("http://melative.com/api/social/entry_edit.json",10)		  		  // release data from memory		  form2 = nil		  If socket1.httpstatuscode = 200 then		    success = true		    self.hide		  else		    // Show Error		    self.errboxshow("Melative Library was unable to post your update on Melative",   "Check to see if your internet connection is working or revertify your Melative account information and try posting your update again.")		    pushbutton1.enabled = true		    progresswheel1.visible = false		  end if		  		End Sub	#tag EndEvent#tag EndEvents#tag Events PushButton2	#tag Event		Sub Action()		  self.hide		End Sub	#tag EndEvent#tag EndEvents