#tag ModuleProtected Module KeychainAccess	#tag Method, Flags = &h0		Sub ChangePassword(Password as string)		  try		    Dim ItemToFind as KeyChainItem		    Dim NewItem as KeyChainItem		    Dim s As String		    ItemToFind = New KeyChainItem		    		    // Indicate the name of the application whose keychain item you wish to find		    ItemToFind.ServiceName = ServiceName		    s = System.KeyChain.FindPassword(ItemToFind)		    		    // Delete existing keychain		    ItemtoFind.Delete		    		    // Save new password to keychain		    If System.KeyChainCount > 0 then		      NewItem = New KeyChainItem		      NewItem.ServiceName = "MAL Client OS X"		      System.KeyChain.AddPassword NewItem, Password		      		    end if		  catch		  end try		End Sub	#tag EndMethod	#tag Method, Flags = &h0		Function DeletePassword() As boolean		  Try		    Dim ItemToFind as KeyChainItem		    Dim s As String		    ItemToFind = New KeyChainItem		    // Indicate the name of the application whose keychain item you wish to find		    ItemToFind.ServiceName = ServiceName		    s = System.KeyChain.FindPassword(ItemToFind)		    		    // Delete existing keychain		    ItemtoFind.Delete		    		    Return True		  catch		    Return False		  end try		End Function	#tag EndMethod	#tag Method, Flags = &h0		Function LoadPassword() As string		  try		    Dim ItemToFind as KeyChainItem		    Dim password As String		    		    ItemToFind = New KeyChainItem		    		    // Indicate the name of the application whose keychain item you wish to find		    ItemToFind.ServiceName = ServiceName		    		    // Get application's password from the system keychain		    password = System.KeyChain.FindPassword(ItemToFind)		    		    // Output Password		    Return password		  catch		    		  end		End Function	#tag EndMethod	#tag Method, Flags = &h0		Sub SavePassword(Password as String)		  try		    Dim NewItem as KeyChainItem		    If System.KeyChainCount > 0 then		      		      NewItem = New KeyChainItem		      'Indicate the name of the application		      NewItem.ServiceName = ServiceName		      		      'Create a new keychain item for the application and assign the password		      System.KeyChain.AddPassword NewItem, Password		    Else		    End if		  catch		  end try		End Sub	#tag EndMethod	#tag Note, Name = Usage		Usage:		Loading a Password:		LoadPassword() as string				Saving a Password:		SavePassword(Password as string)				Changing a Password:		ChangePassword(Password as string)				Delete a Password		DeletePassword as Boolean				Part of MAL Client OS X and covered under GPL V3	#tag EndNote	#tag Constant, Name = ServiceName, Type = String, Dynamic = False, Default = \"MAL Client OS X", Scope = Public	#tag EndConstant	#tag ViewBehavior		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty	#tag EndViewBehaviorEnd Module#tag EndModule