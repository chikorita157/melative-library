#tag ClassProtected Class WindowZoomMenuItemInherits MacWindowActionMenuItem	#tag Event		Sub EnableMenu()		  #if targetMacOS		    soft declare function FrontNonFloatingWindow Lib CarbonFramework () as Ptr		    		    dim frontWindow as Ptr = FrontNonFloatingWindow		    if frontWindow = nil then		      return		    end if		    		    soft declare function GetWindowAttributes lib CarbonFramework (window as Ptr, ByRef outAttributes as UInt32) as Int32		    		    dim menuAttributes as UInt32		    dim OSStatus as Int32 = GetWindowAttributes(frontWindow, menuAttributes)		    		    const kWindowFullZoomAttribute = 6		    		    me.Enabled = ((menuAttributes and kWindowFullZoomAttribute) = kWindowFullZoomAttribute)		  #endif		End Sub	#tag EndEvent	#tag Event		Function GetCommandID() As String		  const kHICommandZoomWindow = "zoom"		  return kHICommandZoomWindow		End Function	#tag EndEvent	#tag Event		Sub SendingCommand()		  if Window(0) is nil then //shouldn't happen, but just in case...		    return		  end if		  		  #if targetCarbon		    soft declare function IsWindowInStandardState lib CarbonFramework (inWindow as WindowPtr, inIdealSize as Ptr, outIdealStandardState as Ptr) as Boolean		    		    if not IsWindowInStandardState(Window(0), nil, nil) then		      SetState Window(0)		    end if		  #endif		End Sub	#tag EndEvent	#tag Method, Flags = &h21		Private Sub SetState(w as Window)		  if w is nil then		    return		  end if		  		  soft declare Sub SetWindowUserState Lib "Carbon.framework" (w As WindowPtr, r As Ptr)		  		  const sizeOfRect = 8		  dim m As new MemoryBlock(sizeOfRect)		  m.Short(0) = w.Top		  m.Short(2) = w.Left		  m.Short(4) = w.Top + w.Height		  m.Short(6) = w.Left + w.Width		  		  SetWindowUserState w, m		  		End Sub	#tag EndMethod	#tag Constant, Name = CarbonFramework, Type = String, Dynamic = False, Default = \"Carbon.framework", Scope = Private	#tag EndConstant	#tag ViewBehavior		#tag ViewProperty			Name="AutoEnable"			Group="Behavior"			InitialValue="0"			Type="Boolean"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="Checked"			Group="Behavior"			InitialValue="0"			Type="Boolean"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="CommandKey"			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="Enabled"			Group="Behavior"			InitialValue="0"			Type="Boolean"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="Icon"			Group="Behavior"			InitialValue="0"			Type="Picture"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="Index"			Visible=true			Group="ID"			InitialValue="-2147483648"			Type="Integer"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="KeyboardShortcut"			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="Left"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Name"			Visible=true			Group="ID"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="Super"			Visible=true			Group="ID"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Text"			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="Top"			Visible=true			Group="Position"			InitialValue="0"			InheritedFrom="Object"		#tag EndViewProperty		#tag ViewProperty			Name="Visible"			Group="Behavior"			InitialValue="0"			Type="Boolean"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="_Bold"			Group="Behavior"			InitialValue="0"			Type="Boolean"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="_Italic"			Group="Behavior"			InitialValue="0"			Type="Boolean"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="_mIndex"			Group="Behavior"			InitialValue="0"			Type="Integer"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="_mName"			Group="Behavior"			Type="String"			EditorType="MultiLineEditor"			InheritedFrom="MenuItem"		#tag EndViewProperty		#tag ViewProperty			Name="_Underline"			Group="Behavior"			InitialValue="0"			Type="Boolean"			InheritedFrom="MenuItem"		#tag EndViewProperty	#tag EndViewBehaviorEnd Class#tag EndClass